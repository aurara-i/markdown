**惯性导航原理与算法设计**
<br>导航系统包括：导航器件（原始观测数据）导航算法（导航参数）辅助支持设备
<br>直接定位包括：几何交汇定位，数据库匹配定位
<br>惯性导航需要在惯性系下，地球系下利用牛三进行惯性导航，需要加上1、旋转坐标系中的力学修正：离心力哥式力。2、地球引力场的影响：加需要从加速度计测量中扣除引力加速度分量3、地球曲率的影响<br>
<br>**地球坐标系**
<br>惯性坐标系(i系)：没有加速度或者旋转的理想坐标系，不随地球自转而旋转。z指向协议北极点，x轴指向春分点。
<br>地心地固坐标系(e系)：原点和i系相同，z轴重合，但是其他轴存在指向差异，由于地球自转造成。
<br>导航坐标系（n系）：三轴坐标系基于椭球面，法线，切平面。注意：除了在南北极和赤道外n系z轴不通过椭球中心，n系的 z 轴也不是与当地铅垂线严格平行，二者之间的差异称作垂线偏差（坐标系定义为参考椭球，这种基准面的不同造成偏差）。导航坐标系 在实际工程中几乎就是 当地水平坐标系（ENU 或 NED）。
<br>它的特点是：
  - 坐标轴与当地的“北-东-天”或“北-东-地”对齐。将 n 系称作当地水平坐标系也是一种足够精确的近似，因为其 x 轴和 y 轴并不是位于真正的水平面上。然而，一般情况下这一差异足够小，在惯性导航应用中可忽略其影响。
  - n 系对于描述姿态非常方便。
  - n 系在地球两极地区存在奇异性，因为北极和南极没有明确的东向和北向定
义。因此，在 n 系下实现的惯性导航算法不适合在地球两极地区附近使用，应该使用其
他坐标系进行导航解算，如e系。
  - 地球表面是曲面，载体沿着椭球面不管朝哪个方向运动，其轨迹都是一段弧线。n 系坐标轴在空间中的上述角度变化对时间求导的结果称作位移角速度（transportrate 或 craft rate），记作 ω en ，因为该角速度是由载体运动产生的位移所导致的。
<br>载体坐标系（v系）
<br>传感器坐标系（b系）：除非特别说明，后续章节假定b系与v系重合，例如将载体系简写为b系。<br>
<br>**地球椭球**
<br>地球自转假设为一个恒定的角速度向量ωie，地球自转角速度向量在i系或e系中的投影ω <sup>i</sup><sub>ie</sub> = ω <sup>e</sup><sub>ie</sub>
<br>在 n 系中的投影为ω nie,
[ω e cos φ
0
−ω e sin φ]
![](https://github.com/aurara-i/markdown/blob/main/picture/2025-09-21%2017-28-45%20%E7%9A%84%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png)
<br>参考椭球面的曲率半径：子午圈、卯酉圈曲率半径。速度和大地坐标对时间的导数：
![](https://github.com/aurara-i/markdown/blob/main/picture/2.2.png)
v N 、v E 和 v D 分别是载体相对于地球的速度（简称地速）向量在当前位置点的北向、东向和地向的投影分量。<BR>
<br>**地球正常重力场**<br>
<br>地球万有引力导致的加速度称作引力加速度，记作 g；重力导致的加速度称作重力加速度，用gp表示，离心力导致的加速度为 −ω ie × (ω ie × r eb )。位于参考椭球表面的
物体所受的加速度如图2.15所示，并满足以下关系：
g p = g − ω ie × (ωie × reb )
<br>因为不能准确知道地球的实际形状和质量分布，因此重力加速度也无法直接准确地计算出来。为此，工程上引入与之近似的**正常重力模型**。将地球附近的引力场与离心力场叠加，形成重力的等势面，并对其进行近似，使其
对应一个规则的椭球体，将这个椭球体称为**正常椭球，相应的重力场称为正常重力场**
<br>**建立正常椭球通常需要 4 个参数：**（1）椭球长半轴 a；（2）与形状相关的参数，即动力形状因子 J 2 或扁率 f；（3）物理尺度参数GM, 即包括大气层在内的地球总质量乘以牛顿引力常数；（4）地球自转角速率 ω e 。
<br>常用随机过程模型<br>
白噪声、随机常数、随机游走和一阶高斯马尔可夫过程.<br>
高斯白噪声：每个时刻的噪声样本是独立的（时间上不相关）每个样本都服从高斯分布。<br>
导航：IMU 测量噪声通常建模为高斯白噪声，滤波：卡尔曼滤波假设过程噪声、测量噪声为高斯白噪声<br>
随机常数：在所有时刻都是常数的随机过程，但这个常数本身是一个随机变量的样本实现。随机常数过程的自相关函数为常值，该随机过程是完全时间相关的，给定该过程某个时间的取值，则可以确定其他所有时刻的值。<br>
陀螺仪零偏误差的一个重要来源 —— 随机常数,这种误差在一次导航过程中可以当成常数处理，但不同任务（不同上电周期）需要重新标定或估计。<br>
随机游走：随机游走是白噪声积分的结果。<br>
一阶高斯马尔科夫过程：bk+1​=ϕbk​+wk​。下一时刻的值，大部分来自前一时刻（有“记忆”），但会逐渐“忘记”，因为 ϕ<1ϕ<1。同时加上一点新的随机扰动 wkwk。<br>
<br>**imu输出**<br>
加速度：v˙n=fn+gn−(2ωien​+ωenn​)×v  fn：惯导加速度计测得的加速度（已换算到导航系）gn：重力加速度（因为比力是消掉了重力的，并且这里的g根据上面的公式是已经加上了离心加速度的） 最后一项：科氏力修正（地球自转 + 导航坐标系运动带来的虚拟力）<br>角速度：角运动不仅有地球自转角速度向量 ω ie 和位移角速度 ω en （以 n 系为参考系时），同时载体还可以做姿态机动，即 b 系相对于当地水平坐标系（n 系）有角运动，对应的角速度记为 ωnb：ωib = ωie + ωen + ωnb

<br>**传感器误差**<br>
静态误差，是当传感器的输入为零时表现出来的误差。动态误差，是只有当传感器输入不为零时才能表现出来的误差，也称乘性误差。
噪声类误差表现为时间上的强随机性，相邻历元间的相关性弱，主要包括高频随机噪声和量化噪声等。噪声类误差随机性强，无法进行实验室标定和在线估计。<br>非噪声类也称系统性误差。系统性误差包括零偏误差、比例因子误差、交轴耦合误差和非线性误差等。 ![](https://github.com/aurara-i/markdown/blob/main/picture/2025-09-22%2018-52-01%20%E7%9A%84%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png) <br>
<br>零偏误差：1、常值零偏（constant bias），指惯性传感器在出厂时固有的且恒定不变的零偏部分。2、零偏重复性（bias repeatability），全称为零偏逐次上电重复性（run-to-run biasrepeatability），是惯性传感器的经典性能指标之一，用以衡量在相同条件、不同次上电启动时零偏的不一致程度。3、零偏稳定（bias instability），严格来说应称为单次上电零偏不稳定性（in-run biasinstability），该指标反映了器件在上电稳定后零偏随时间缓慢变化的特征。
<br>比例因子误差：比例因子（scale factor）又称标度因数，定义为惯性传感器输出变化量与输入变化量的比值，即惯性传感器输入输出统一单位之后，输出-输入直线的斜率。**比例因子误差**（scale factor error）是指性传感器的实际比例因子与理想比例因子之间的差异。比例因子误差是一种乘性误差，例如由加速度计比例因子误差导致的加速度计输出误差，与该敏感轴方向的真实比力成正比。
<br>交轴耦合误差：由于惯性传感器的敏感轴与 IMU 坐标系的正交坐标轴之间不对准所引起的，有时也称为非正交。
<br>随机噪声：对于惯性传感器而言，随机噪声的成因复杂多变。例如，传感器的内部敏感结构和电路元件的热噪声；在测量过程中，传感器受到外部震动的干扰，导致测量结果出现随机波动。陀螺和加速度计的随机噪声通常也分别被称为角度随机游走（angular random walk，ARW）和速度随机游走（velocity random walk，VRW）。
<br>量化误差：量化误差是一切量化操作所固有的，只要进行数字量化编码采样，传感器输出的理想值与实际量化值之间就会存在这种细微的差异。
<br>**allan方差分析**一种独立且通用的时间序列分析工具，**Step 1 分块**按窗口长度将序列 y 分成 N c 块，每块包n个数据点，块间无重叠。**Step 2 块平均**分别计算各块内n个数据点的均值。**Step 3 计算Allan方差**相邻块的平均值求差。**Step 4 统计RMS值**根据Step 3求得的差值，统计RMS值。
![]()
<br>**惯性初始对准**<br>
<br>惯性导航解算是一个时间积分过程，通过加速度的积分可以获得速度和位置信息，通过对角速度的积分则能够得到载体的姿态。在进行积分运算时，必须在导航开始之前预先确定积分常数（也称积分初值）。该过程通常被称为惯性导航的初始化，或者称为初始对准。初始化参数主要包括位置、速度和姿态，有时还需要对惯性传感器的零偏、比例因子误差等导航状态以外的参数进行增广估计。有：初始位置和速度（GNSS·接收机,当惯导的位置或速度信息由其他传感器提供时，通常需要进行杆臂补偿。）、初始姿态（diffic）、惯性传感器误差。
<br>平台式初始姿态<br>
<br>阐述水平姿态角与航向角初始化的一般性原理，将姿态对准过程划分为两个阶段：一是通过加速度计调平（accelerometer leveling）来确定水平姿态角（横滚角和俯仰角），二是通过陀螺寻北（gyro compassing）来确定航向角。**加速度计调平和陀螺寻北是平台式惯性导航系统对准的两个关键步骤，旨在将导
航平台调整至水平状态和确定初始航向。**
<br>1、俯仰角：θ ≈fx/g 俯仰角误差 δθ 的一阶近似为δθ ≈δfx/g。横滚角的初始对准误差分析与之类似
<br>对于误差来说：fm=(1+K)f+b+η。（
fm：加速度计的 测量值 (measured specific force)，不是“误差”。
f：真实的比力（true specific force）。
K：比例因子误差（scale factor error）。
b：零偏（bias）。
η：噪声（通常建模为高斯白噪声或者一阶高斯马尔可夫过程）。）当倾角为小角度时，静态测量过程中水平方向的加速度计实际感知的比力基本为零，比例因子误差影响甚微。主要影响因素是加速度计的逐次上电零偏重复性和噪声。δθ bias =b a/g。式中，b a 为加速度计零偏，δθ bias 为零偏导致的横滚角或俯仰角误差。加速度计测量噪声的影响，可通过对静止时段内加速度计的输出求平均来降低其影响，理论上静止时间越长，传感器噪声的影响越小。即便是低成本的消费级 IMU 芯片，也能准确地确定水平姿态角。
<br>2、陀螺寻北：陀螺必须足够精确，以准确测量地球自转角速度。已完成水平姿态角的计算。IMU 必须处于严格静止状态。
<br>捷联贯导初始对准<br>
<br>粗对准：捷联惯性导航系统没有物理平台，而是构建一个等价的“数学平台”，这一过程称为解析粗对准。
ωib<sup>b</sup>：载体坐标系b 相对于惯性系 i 的角速度，在 b 坐标系下的表示。
<br>1、静止采集：测量 fb,ωieb。已知参考：fn,ωien来自重力和地球自转公式。
<br>2、解算方向余弦矩阵 ：Cbn：两组已知向量在不同坐标系下的表达 → 求解坐标变换矩阵。
常用方法：三向量法 / Wahba 问题 / QUEST 算法。
<br>3、提取姿态角：从 Cbn中解算 roll、pitch、yaw。
<br>**惯导算法**<br>
<br>惯性导航解算是根据加速度计的比力测量值和陀螺的角速度测量值自主推算载体位置、速度和姿态的过程，称作惯导机械编排。
<br>**两条主线构成：一是速度和位置积分运算，从加速度计的比力测量值到位置输出，贯穿了整个机械编排过程；二是姿态积分运算，即陀螺的角速度测量值积分为载体姿态。** 可以说机械编排的重点在于姿态解算，甚至整个捷联惯导算法的发展历史也是围绕着姿态的精确求解而展开的。
<img width="664" height="335" alt="图片" src="https://github.com/user-attachments/assets/7996f304-904c-47f9-8ceb-b15f35f78fb4" />
<br>首先，对于b系相对于惯性系的角速度减去n系相对于b系旋转后(Cn<sup>b</sup>)的角速度获得b系相对于n系下的角速度，进行积分后获得姿态。对于加速度计的输出，b系相对于i系下的比力，通过乘以获得b系相对于n系的旋转（Cb<sup>n</sup>这个是通过姿态结果获得的）获得b系相对于n系下的比力。这个比力加上修改离心力的重力加速度和哥式力后进行积分获得速度。这个速度再积分获得位置。
<br>其中，ωen<sup>n</sup>，速度和位置都有关系。Cen是地固系到导航系的方向余弦矩阵​。ωien=[ωecos⁡L0−ωesin⁡L]。
<br>我的一些问题：1、科里奥利效应。在牛顿力学里，如果你在一个旋转的参考系里看运动物体，就会出现一些“假想力”：科里奥利力（Coriolis force）离心力（centrifugal force）等，−2ωien×vn就是我们熟知的科里奥利项，在北半球，运动的物体会被偏向右侧。
<br>2、离心力导致的加速度为 −ω ie × (ω ie × r eb )去那？地球的真实引力场加速度是 
gtrue，它指向地心。但是人和惯导系统感受到的“有效重力”并不是 gtrue，而是减去了地球自转导致的离心加速度。它没有单独出现，是因为 被吸收到 gn里面了。
<BR>3、惯性导航算法中计算wnen和Cne的时候为什么需要位置r?ωenn​和CNE的计算需要用到φ：纬度、经度、纬度、经度变化率。ωenn=[λ˙cos⁡φ −φ˙ −λ˙sin⁡φ]；φ˙​=RM​+hvN​​,λ˙=(RN​+h)cosφvE​​；Cne​=−sinφcosλ−sinλ−cosφcosλ​−sinφsinλcosλ−cosφsinλ​cosφ0−sinφ​
<br>4、要规范表达，输入的到底的是那些量：三轴加速度计-惯性系的加速度，“扣掉重力的部分”，三轴陀螺仪：测量机体系相对于惯性系的角速度在机体系下的投影。
<br>5、姿态问题？导航关心的姿态是b系与n系之间的角度关系，陀螺并不能直接测量载体相对于n系的角速度ωnb ，只能测量载体相对于i系的角速度ωib。为此，需要从陀螺的角速度测量值中补偿地球自转角速度ωie和位移角速度ωen，前者是由于地球在惯性空间中转动导致的，后者是由于n系跟随载体在地球表面这一曲面上运动从而相对于e系转动造成的。
<br>6、为什么要进行离散化处理？惯导算法必须离散化，是因为输入本身就是离散的，而计算机也只能进行离散数值计算。时间离散化处理中：微分和积分需要注意方向的变化，方向在离散化采样过程中会有损失。积分离散化过程中对向量方向的变化应做尽可能精确的补偿，这将导致惯导姿态算法中出现圆锥效应补偿项，以及速度算法中的旋转效应补偿项和划桨效应补偿项。离散积分丢掉高阶项引起的，要在惯导算法里额外补偿。
<br>圆锥效应、划桨效应、双子效应出现在离散积分数值实现中，是“如何正确用 IMU 的有限频率数据近似连续积分”的问题。
<br>**姿态算法**<br> 惯导姿态的重要作用体现在以下两个方面：一方面是作为基础的导航参数对外
输出；另一方面用于比力向量及其他三维向量的投影变换。
  - 平台式惯导将三轴加速度计安装在陀螺控制的空间稳定平台上，并始终与选定参考坐标系的轴线对齐，导航解
算只需对加速度计的测量值按时间积分即可得到载体的速度和位置。
  - 捷联贯导由于器件之间固连，需要时刻计算出载体相对于参考坐标系的相对角度关系，从而将加速度计的比力向量投影变换到参考坐标系下再做积分运算，得到载体的速度和位置。Cbn*fibb
  - 角度描述
    - 欧拉角：转轴顺序记为“ZYX“。当 3 个欧拉角都是小角度时，其三角函数取一阶近似：sin(x) ≈ x，cos(x) ≈ 1。从 t 时刻到 t + ∆t 时刻, b 系从b(t) 系转动到 b(t + ∆t) 系，当 ∆t 为小量时，对应的欧拉角组与角增量相等。所以小角度欧拉角组等于角速度对时间积分。
    - 姿态角：航向、付仰角、横滚角。
    - 方向余弦矩阵：余弦矩阵是行列式为 1 的正交矩阵。
- **方向余弦矩阵微分方程**：Ċ bR = C bR (ω Rb b  ×)
    - 微分方程求解：Ċ(t) = C(t)Ω(t)
    <br>这是一个典型的时变系数齐次微分方程，需要采用毕卡迭代法求解，这是一种用于求解微分方程初值问题的数学方法，其基本思想是从一个初始猜测解出发，通过迭代过程逐步逼近微分方程的实际解。C(t)= C(0)exp[fΩ(τ )dτ] 将图6.54带入得到C <sub>R</sup><sup>b </sup>(t) = C<sub>R</sub><sup>b(t)</sup> = C <sup>R</sup><sub>b(0)</sub> C<sup>b(0)</sup> <sub>b(t)</sub>。
<br>所以姿态矩阵离散化更新的第推状态核心思想，就是t时刻从b系到i系的旋转矩阵等于从b系t-1时刻到t时刻的的旋转矩阵（这里对应小角度的旋转），再左乘k-1时刻从b系到i系旋转矩阵。<img width="979" height="352" alt="图片" src="https://github.com/user-attachments/assets/ac6ba324-d85f-4ac2-8acf-5bddd0337bd5" />新时刻的向量先用增量变换到旧时刻的 b 系”，再用已知的 Cib(k)变到 i 系——这样就得到 Cib(k+1)
- **四元数**
    - q0= “旋转角的一部分”（余弦）(q1,q2,q3) = “旋转轴方向 × 旋转角的一部分”（正弦）
- **等效旋转矢量**（唯一可以对旋转过程进行线性内插的方法）
    - 小角度的转动是可交换顺序的。等效旋转矢量可通过罗德里格斯（Rodrigues）公式转换为方向余弦矩阵。
    - 姿态单子样、双子样算法：ϕ k = ∆θ k此时，根据一个历元的角增量测量值 ∆θ k 即可求解等效旋转矢量，故称作姿态的单子样算法。ϕ k= ∆θ k + 1/12 ∆θ k−1 × ∆θ k。第二项是姿态更新算法的双子样不可交换误差补偿项。该叉积项在载体做圆锥运动时会产生显著姿态误差累积，常称为**圆锥效应补偿项**
    - 不同小角度的旋转不满足交换律（旋转是非交换的），所以简单累加会产生误差，这个误差就是所谓的**圆锥效应**
- **n系下的姿态更新算法**
    - 姿态要做的是：把陀螺角速度积分 → 得到角增量 → 转成旋转矩阵或四元数 → 更新姿态。 直接把角速度简单积分，会丢掉“旋转非交换性”的信息误差，就是圆锥效应。
    - 姿态四元数更新的链式乘法：qb(k)n​=qn(k−1)n​∘qb(k−1)n​∘qb(k)b(k−1)
    - 1、陀螺积分 → 得到角增量
    - 2、为了补偿旋转非交换性误差，我们不用“单纯的角增量”，而是构造 等效旋转矢量：φk​=Δθk​+121​Δθ（k−1）​×Δθk。交叉项 1/12Δθ（k−1）×Δθk：补偿“旋转非交换性”造成的圆锥误差。
    - 3、等效旋转矢量 φk转换成一个小旋转四元数
    - 4、和上一步姿态、n系更新的四元数链式相乘 → 得到当前姿态
    - 5、定期归一化，保持四元数单位长度。
<br>**速度算法**<br>
<br>关心载体相对于地球的速度，简称地速，记作veb ≜ dreb/dt.二阶导数则为加速度，这里的加速度：ℹi系下满足牛顿第二定律，a=f+g-wv。f是比力，缺少重力加速度项，最后一项是哥式加速度。
<br>速度微分方程：在 i 系、e 系和 n 系下对速度向量 v 求导，建立起与比力测量值之间的函数关系，构建载体运动的力学方程。
<br>i系微分方程：<img width="746" height="426" alt="图片" src="https://github.com/user-attachments/assets/e85a14a0-f636-4e99-a849-a9437367abb5" />
<br>e系速度微分方程:<img width="258" height="295" alt="图片" src="https://github.com/user-attachments/assets/9b185110-b422-4bcc-b673-3c2abeed9380" />
<br>n系微分方程:<img width="297" height="351" alt="图片" src="https://github.com/user-attachments/assets/4175899e-aa6f-4222-8111-1b7e4af8870c" />
<br>**n系速度更新算法:**
<br>**位置算法**<br>
<br>与姿态和速度更新算法相比，它引起的计算误差一般相对较小，可采用比较简单的梯形积分进行简化处理。
<br>**贯导误差**<br>
<br>惯导的误差源主要包括 1 ：1）惯性传感器误差，即陀螺和加速度计的噪声、零偏、比例因子误差和交轴耦合等；2）导航初始化误差，包括位置、速度和姿态等参数的初始对准误差；3）重力误差，主要是重力模型不精确和位置误差导致的重力加速度计算误差等。
<br>**机械编排**<br>

<br>我的问题：
<br>1、为什么要先速度后位置后姿态？
    <br>速度：需要 “IMU 的加速度测量值”+“前一时刻的速度”+“地球重力 / 哥氏力补偿”—— 这些都是 “现成的”（IMU 数据是实时测的，前一时刻速度是历史数据），不需要依赖当前时刻的位置或姿态。
    <br>位置：需要 “当前时刻的速度”+“前一时刻的位置”—— 位置是 “速度对时间的积分”（比如开车时，知道速度 60km/h、开 1 小时，才能算位置走了 60 公里），没有速度，位置根本算不出来。
    <br>姿态：需要 “IMU 的角速度测量值”+“当前时刻的位置和速度”—— 姿态是描述 “载体朝向” 的，而 “载体朝向的计算” 依赖于 “导航系的旋转状态”（比如地球自转、载体运动导致导航系变化），而导航系的旋转状态又需要用最新的位置和速度来算（比如不同纬度的地球自转角速度投影不一样，速度不同导致导航系相对地球的角速度也不一样）。
<br>1. 输入数据:
<br>历史数据
    <br>位置：pk−2​（tk−2​时刻）、pk−1​（tk−1​时刻，含纬度ϕk−1​、经度λk−1​、高程hk−1​）；
    <br>速度：vk−2n​（tk−2​时刻，导航系下）、vk−1n​（tk−1​时刻，导航系下）；
    <br>姿态：qb(k−1)n(k−1)​（tk−1​时刻，载体系b到导航系n的四元数）。
<br>IMU测量值
    线加速度增量：Δvk−1​（tk−2​→tk−1​）、Δvk​（tk−1​→tk​）；
    角速度增量：Δθk−1​（tk−2​→tk−1​）、Δθk​（tk−1​→tk​）；
<br>第一步 速度更新  速度是位置和姿态的基础，需先通过 IMU 线加速度增量，补偿地球运动（重力、哥氏力）和 IMU 误差（旋转、划桨效应），得到当前速度。




<BR>ins gnss组合导航<br>
<br>松组合是 GNSS 的导航定位结果与惯导的组合，GNSS 解算的位置和速度结果与INS 推算的位置和速度对比，求差后作为组合导航滤波器的观测输入，用于估计 INS 导航误差和惯性传感器误差，对惯导机械编排的位置、速度和姿态进行校正，估计的惯性传感器误差反馈至机械编排前端补偿 IMU 原始测量误差。
<br>紧组合是 GNSS 的原始观测与惯导的组合，导航滤波器的观测输入是 GNSS 的伪距、伪距率、多普勒及载波相位等
数据，据此估计 INS 误差、惯性传感器误差和 GNSS 接收机的时钟偏差与漂移。因此，紧组合是 INS 与 GNSS 在原始观测域的组合，组合层次比松组合更深。
<br>








