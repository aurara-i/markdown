**惯性导航原理与算法设计**
<br>导航系统包括：导航器件（原始观测数据）导航算法（导航参数）辅助支持设备
<br>直接定位包括：几何交汇定位，数据库匹配定位
<br>惯性导航需要在惯性系下，地球系下利用牛三进行惯性导航，需要加上1、旋转坐标系中的力学修正：离心力哥式力。2、地球引力场的影响：加需要从加速度计测量中扣除引力加速度分量3、地球曲率的影响<br>
<br>**地球坐标系**
<br>惯性坐标系(i系)：没有加速度或者旋转的理想坐标系，不随地球自转而旋转。z指向协议北极点，x轴指向春分点。
<br>地心地固坐标系(e系)：原点和i系相同，z轴重合，但是其他轴存在指向差异，由于地球自转造成。
<br>导航坐标系（n系）：三轴坐标系基于椭球面，法线，切平面。注意：除了在南北极和赤道外n系z轴不通过椭球中心，n系的 z 轴也不是与当地铅垂线严格平行，二者之间的差异称作垂线偏差（坐标系定义为参考椭球，这种基准面的不同造成偏差）。导航坐标系 在实际工程中几乎就是 当地水平坐标系（ENU 或 NED）。
<br>它的特点是：
  - 坐标轴与当地的“北-东-天”或“北-东-地”对齐。将 n 系称作当地水平坐标系也是一种足够精确的近似，因为其 x 轴和 y 轴并不是位于真正的水平面上。然而，一般情况下这一差异足够小，在惯性导航应用中可忽略其影响。
  - n 系对于描述姿态非常方便。
  - n 系在地球两极地区存在奇异性，因为北极和南极没有明确的东向和北向定
义。因此，在 n 系下实现的惯性导航算法不适合在地球两极地区附近使用，应该使用其
他坐标系进行导航解算，如e系。
  - 地球表面是曲面，载体沿着椭球面不管朝哪个方向运动，其轨迹都是一段弧线。n 系坐标轴在空间中的上述角度变化对时间求导的结果称作位移角速度（transportrate 或 craft rate），记作 ω en ，因为该角速度是由载体运动产生的位移所导致的。
<br>载体坐标系（v系）
<br>传感器坐标系（b系）：除非特别说明，后续章节假定b系与v系重合，例如将载体系简写为b系。<br>
<br>**地球椭球**
<br>地球自转假设为一个恒定的角速度向量ωie，地球自转角速度向量在i系或e系中的投影ω <sup>i</sup><sub>ie</sub> = ω <sup>e</sup><sub>ie</sub>
<br>在 n 系中的投影为ω nie,
[ω e cos φ
0
−ω e sin φ]
![](https://github.com/aurara-i/markdown/blob/main/picture/2025-09-21%2017-28-45%20%E7%9A%84%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png)
<br>参考椭球面的曲率半径：子午圈、卯酉圈曲率半径。速度和大地坐标对时间的导数：
![](https://github.com/aurara-i/markdown/blob/main/picture/2.2.png)
v N 、v E 和 v D 分别是载体相对于地球的速度（简称地速）向量在当前位置点的北向、东向和地向的投影分量。<BR>
<br>**地球正常重力场**<br>
<br>地球万有引力导致的加速度称作引力加速度，记作 g；重力导致的加速度称作重力加速度，用gp表示，离心力导致的加速度为 −ω ie × (ω ie × r eb )。位于参考椭球表面的
物体所受的加速度如图2.15所示，并满足以下关系：
g p = g − ω ie × (ω ie × r eb )
<br>因为不能准确知道地球的实际形状和质量分布，因此重力加速度也无法直接准确地计算出来。为此，工程上引入与之近似的**正常重力模型**。将地球附近的引力场与离心力场叠加，形成重力的等势面，并对其进行近似，使其
对应一个规则的椭球体，将这个椭球体称为**正常椭球，相应的重力场称为正常重力场**
<br>**建立正常椭球通常需要 4 个参数：**（1）椭球长半轴 a；（2）与形状相关的参数，即动力形状因子 J 2 或扁率 f；（3）物理尺度参数GM, 即包括大气层在内的地球总质量乘以牛顿引力常数；（4）地球自转角速率 ω e 。
<br>常用随机过程模型<br>
白噪声、随机常数、随机游走和一阶高斯马尔可夫过程.<br>
高斯白噪声：每个时刻的噪声样本是独立的（时间上不相关）每个样本都服从高斯分布。<br>
导航：IMU 测量噪声通常建模为高斯白噪声，滤波：卡尔曼滤波假设过程噪声、测量噪声为高斯白噪声<br>
随机常数：在所有时刻都是常数的随机过程，但这个常数本身是一个随机变量的样本实现。随机常数过程的自相关函数为常值，该随机过程是完全时间相关的，给定该过程某个时间的取值，则可以确定其他所有时刻的值。<br>
陀螺仪零偏误差的一个重要来源 —— 随机常数,这种误差在一次导航过程中可以当成常数处理，但不同任务（不同上电周期）需要重新标定或估计。<br>
随机游走：随机游走是白噪声积分的结果。<br>
一阶高斯马尔科夫过程：bk+1​=ϕbk​+wk​。下一时刻的值，大部分来自前一时刻（有“记忆”），但会逐渐“忘记”，因为 ϕ<1ϕ<1。同时加上一点新的随机扰动 wkwk。<br>
<br>**imu输出**<br>
加速度：v˙n=fn+gn−(2ωien​+ωenn​)×v  fn：惯导加速度计测得的加速度（已换算到导航系）gn：重力加速度 最后一项：科氏力修正（地球自转 + 导航坐标系运动带来的虚拟力）<br>角速度：角运动不仅有地球自转角速度向量 ω ie 和位移角速度 ω en （以 n 系为参考系时），同时载体还可以做姿态机动，即 b 系相对于当地水平坐标系（n 系）有角运动，对应的角速度记为 ω nb：ω ib = ω ie + ω en + ω nb

<br>**传感器误差**<br>
静态误差，是当传感器的输入为零时表现出来的误差。动态误差，是只有当传感器输入不为零时才能表现出来的误差，也称乘性误差。
噪声类误差表现为时间上的强随机性，相邻历元间的相关性弱，主要包括高频随机噪声和量化噪声等。噪声类误差随机性强，无法进行实验室标定和在线估计。<br>非噪声类也称系统性误差。系统性误差包括零偏误差、比例因子误差、交轴耦合误差和非线性误差等。 ![](https://github.com/aurara-i/markdown/blob/main/picture/2025-09-22%2018-52-01%20%E7%9A%84%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png) <br>
<br>零偏误差：1、常值零偏（constant bias），指惯性传感器在出厂时固有的且恒定不变的零偏部分。2、零偏重复性（bias repeatability），全称为零偏逐次上电重复性（run-to-run biasrepeatability），是惯性传感器的经典性能指标之一，用以衡量在相同条件、不同次上电启动时零偏的不一致程度。3、零偏稳定（bias instability），严格来说应称为单次上电零偏不稳定性（in-run biasinstability），该指标反映了器件在上电稳定后零偏随时间缓慢变化的特征。
<br>比例因子误差：比例因子（scale factor）又称标度因数，定义为惯性传感器输出变化量与输入变化量的比值，即惯性传感器输入输出统一单位之后，输出-输入直线的斜率。**比例因子误差**（scale factor error）是指性传感器的实际比例因子与理想比例因子之间的差异。比例因子误差是一种乘性误差，例如由加速度计比例因子误差导致的加速度计输出误差，与该敏感轴方向的真实比力成正比。
<br>交轴耦合误差：由于惯性传感器的敏感轴与 IMU 坐标系的正交坐标轴之间不对准所引起的，有时也称为非正交。
<br>随机噪声：对于惯性传感器而言，随机噪声的成因复杂多变。例如，传感器的内部敏感结构和电路元件的热噪声；在测量过程中，传感器受到外部震动的干扰，导致测量结果出现随机波动。陀螺和加速度计的随机噪声通常也分别被称为角度随机游走（angular random walk，ARW）和速度随机游走（velocity random walk，VRW）。
<br>量化误差：量化误差是一切量化操作所固有的，只要进行数字量化编码采样，传感器输出的理想值与实际量化值之间就会存在这种细微的差异。
<br>**allan方差分析**一种独立且通用的时间序列分析工具，**Step 1 分块**按窗口长度将序列 y 分成 N c 块，每块包n个数据点，块间无重叠。**Step 2 块平均**分别计算各块内n个数据点的均值。**Step 3 计算Allan方差**相邻块的平均值求差。**Step 4 统计RMS值**根据Step 3求得的差值，统计RMS值。
![]()
<br>**惯性初始对准**<br>
<br>惯性导航解算是一个时间积分过程，通过加速度的积分可以获得速度和位置信息，通过对角速度的积分则能够得到载体的姿态。在进行积分运算时，必须在导航开始之前预先确定积分常数（也称积分初值）。该过程通常被称为惯性导航的初始化，或者称为初始对准。初始化参数主要包括位置、速度和姿态，有时还需要对惯性传感器的零偏、比例因子误差等导航状态以外的参数进行增广估计。有：初始位置和速度（GNSS·接收机,当惯导的位置或速度信息由其他传感器提供时，通常需要进行杆臂补偿。）、初始姿态（diffic）、惯性传感器误差。
<br>平台式初始姿态<br>
<br>阐述水平姿态角与航向角初始化的一般性原理，将姿态对准过程划分为两个阶段：一是通过加速度计调平（accelerometer leveling）来确定水平姿态角（横滚角和俯仰角），二是通过陀螺寻北（gyro compassing）来确定航向角。**加速度计调平和陀螺寻北是平台式惯性导航系统对准的两个关键步骤，旨在将导
航平台调整至水平状态和确定初始航向。**
<br>1、俯仰角：θ ≈fx/g 俯仰角误差 δθ 的一阶近似为δθ ≈δfx/g。横滚角的初始对准误差分析与之类似
<br>对于误差来说：fm=(1+K)f+b+η。（
fm：加速度计的 测量值 (measured specific force)，不是“误差”。
f：真实的比力（true specific force）。
K：比例因子误差（scale factor error）。
b：零偏（bias）。
η：噪声（通常建模为高斯白噪声或者一阶高斯马尔可夫过程）。）当倾角为小角度时，静态测量过程中水平方向的加速度计实际感知的比力基本为零，比例因子误差影响甚微。主要影响因素是加速度计的逐次上电零偏重复性和噪声。δθ bias =b a/g。式中，b a 为加速度计零偏，δθ bias 为零偏导致的横滚角或俯仰角误差。加速度计测量噪声的影响，可通过对静止时段内加速度计的输出求平均来降低其影响，理论上静止时间越长，传感器噪声的影响越小。即便是低成本的消费级 IMU 芯片，也能准确地确定水平姿态角。
<br>2、陀螺寻北：陀螺必须足够精确，以准确测量地球自转角速度。已完成水平姿态角的计算。IMU 必须处于严格静止状态。
<br>捷联贯导初始对准<br>
<br>粗对准：捷联惯性导航系统没有物理平台，而是构建一个等价的“数学平台”，这一过程称为解析粗对准。
ωib<sup>b</sup>：载体坐标系b 相对于惯性系 i 的角速度，在 b 坐标系下的表示。
<br>1、静止采集：测量 fb,ωieb。已知参考：fn,ωien来自重力和地球自转公式。
<br>2、解算方向余弦矩阵 ：Cbn：两组已知向量在不同坐标系下的表达 → 求解坐标变换矩阵。
常用方法：三向量法 / Wahba 问题 / QUEST 算法。
<br>3、提取姿态角：从 Cbn中解算 roll、pitch、yaw。
<br>**惯导算法**<br>
<br>惯性导航解算是根据加速度计的比力测量值和陀螺的角速度测量值自主推算载体位置、速度和姿态的过程，称作惯导机械编排。
<br>**两条主线构成：一是速度和位置积分运算，从加速度计的比力测量值到位置输出，贯穿了整个机械编排过程；二是姿态积分运算，即陀螺的角速度测量值积分为载体姿态。**














